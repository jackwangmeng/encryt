<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title></title>
        
<!--        &lt;!&ndash;sm4所需js&ndash;&gt;-->
<!--        <script src="js/utils/hex.js"></script>-->
<!--        <script src="js/utils/byteUtil.js"></script>-->
		<script src="sm4-1.0.js"></script>

	</head>
	<body>
		<div style="text-align:center;">
			全部传字符串进去、 不用管什么进制啥的。 你就放你要加密的字符串。 原来的密钥啥的

		</div>
		<script>
			var data = "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"
			// console.log(decryptData_ECB(data, "mLGFIwf7fnYckSqL"))
			// 返回字符串
			function decryptData_ECB(data, secretKey) {
				var byteEcb = base64js.toByteArray(data)
				// 字符串转换成byte
				var key = stringToByte(secretKey);
				var sm4 = new SM4();
				// 进行sm
				var plain = sm4.decrypt_ecb(key,byteEcb);
				console.log(plain)
				// 这里可以不转字符串可以转16进制 方法为Hex.encode
				return Hex.bytesToUtf8Str(plain);
			}
			// 返回字符串
			function encryptData_ECB(data, secretKey) {

				// 可能会出问题的地方 这里没有进行编码
				var inputBytes = stringToByte(data);

				var key = stringToByte(secretKey);
				var sm4 = new SM4();
				var cipher = sm4.encrypt_ecb(key,inputBytes);
				// byte流转base字符串。
				var cipherText = base64js.fromByteArray(cipher);
				if (cipherText != null && cipherText.trim().length > 0)
				{
					cipherText.replace(/(\s*|\t|\r|\n)/g, "");
				}
				return cipherText;
			}

			// 返回字符串
			function decryptData_CBC(data, ivtext,secretKey) {
				var inputBytes = base64js.toByteArray(data);
				var key = stringToByte(secretKey);
				var iv = stringToByte(ivtext);
				var sm4 = new SM4();
				var plain = sm4.decrypt_cbc(key,iv,inputBytes);
				// 这里可以不转字符串可以转16进制 方法为Hex.encode
				return Hex.bytesToUtf8Str(plain);
			}
			// 返回字符串
			function encryptData_CBC(data, ivtext,secretKey) {
				var inputBytes = stringToByte(data);
				var key = stringToByte(secretKey);
				var iv = stringToByte(ivtext);
				var sm4 = new SM4();
				var cipher = sm4.encrypt_cbc(key,iv,inputBytes);
				// byte流转base字符串。
				var cipherText = base64js.fromByteArray(cipher);
				if (cipherText != null && cipherText.trim().length > 0)
				{
					cipherText.replace(/(\s*|\t|\r|\n)/g, "");
				}
				return cipherText;
			}


			function stringToByte(str) {
				var bytes = new Array();
				var len, c;
				len = str.length;
				for(var i = 0; i < len; i++) {
					c = str.charCodeAt(i);
					if(c >= 0x010000 && c <= 0x10FFFF) {
						bytes.push(((c >> 18) & 0x07) | 0xF0);
						bytes.push(((c >> 12) & 0x3F) | 0x80);
						bytes.push(((c >> 6) & 0x3F) | 0x80);
						bytes.push((c & 0x3F) | 0x80);
					} else if(c >= 0x000800 && c <= 0x00FFFF) {
						bytes.push(((c >> 12) & 0x0F) | 0xE0);
						bytes.push(((c >> 6) & 0x3F) | 0x80);
						bytes.push((c & 0x3F) | 0x80);
					} else if(c >= 0x000080 && c <= 0x0007FF) {
						bytes.push(((c >> 6) & 0x1F) | 0xC0);
						bytes.push((c & 0x3F) | 0x80);
					} else {
						bytes.push(c & 0xFF);
					}
				}
				return bytes;
			}

			function strToHexCharCode(str) {
				if(str === "")
					return "";
				var hexCharCode = [];
				hexCharCode.push("0x");
				for(var i = 0; i < str.length; i++) {
					hexCharCode.push((str.charCodeAt(i)).toString(16));
				}
				return hexCharCode.join("");
			}


		</script>

    </body>
</html>